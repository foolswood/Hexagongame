<html>
<style>
.pile {position:relative}
.thing {position:absolute; display: none; width: 100%; height: 100%}
</style>

<body>
<div style="height: 100%; width: 70%; float: left">
<object id="A" type="image/svg+xml" data="hexagons.svg" width="100%" height="60%" style="border:thin solid black"></object>
<div id="tools" style="border: thin solid black; height:40%">
    <div id="tool_menu">
        <select id="tool_select", onchange="tool_select(this.value)">
            <option value="json">Json</option>
            <option value="plain">Plain</option>
        </select>
        <button type="button" onclick="apply()">Apply</button>
    </div>
    <div class="pile">
        <textarea id="json" class="thing">{"maze":["RgB"],"start":[0,0],"end":[1,0]}</textarea>
        <textarea id="plain" class="thing">RgB</textarea>
    </div>
</div>
</div>
<div style="float: left; width:29%; height: 100%; border: thin solid black">
    <div id="analyse_menu">
        <select id="analyser_select", onchange="analyser_select(this.value)">
            <option value="solver">Solver</option>
            <option value="loop">Loops</option>
        </select>
        <button type="button" onclick="analyse()">Analyse</button>
    </div>
    <div class="pile">
        <textarea id="solver" class="thing">Imagine there's a solver, it's easy if you try...</textarea>
        <textarea id="loop" class="thing">Imagine there are loop tools, living for today...</textarea>
    </div>
</div>
</body>

<script src="svg_interface.es" type="text/ecmascript"></script>
<script src="loader.es" type="text/ecmascript"></script>
<script src="std_game.es" type="text/ecmascript"></script>
<script src="menu.es" type="text/ecmascript"></script>

<script>
var iface, active_tool, active_analyser
var level = {"maze": ["RgB"], "start": [0,0], "end": [1,0]}

function analyser_select(val) {
    var prev = active_analyser
    active_analyser = document.getElementById(val);
    active_analyser.style.display = "block"
    if (prev !== undefined) {
        prev.style.display = "none"
    }
}

function tool_select(val) {
    var prev = active_tool
    active_tool = document.getElementById(val)
    active_tool.setup()
    active_tool.style.display = "block"
    if (prev !== undefined) {
        prev.style.display = "none"
    }
}

function preview() {
    gameStandard(iface, level, preview)
}

function apply() {
    active_tool.apply()
    preview()
}

document.getElementById("json").setup = function() {
    this.value = JSON.stringify(level)
}

document.getElementById("json").apply = function() {
    level = JSON.parse(this.value)
}

document.getElementById("plain").setup = function() {
    this.value = level.maze.join('\n')
}

document.getElementById("plain").apply = function() {
    level.maze = this.value.split('\n')
}

window.onload = function() {
    iface = new SVGInterface("A")
    tool_select(document.getElementById("tool_select").value)
    analyser_select(document.getElementById("analyser_select").value)
    active_analyser.style.display = "block"
    preview()
}

</script>
</html>
